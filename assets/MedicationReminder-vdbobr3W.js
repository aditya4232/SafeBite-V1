import{d as S,r as l,u as U,p as L,q as w,s as V,t as k,v as z,j as e,B as d,w as B,C,a as M,x as Y,y as $,L as o,I as h,S as H,e as W,f as Z,g as G,h as f,z as J,A as K}from"./index-DsxZbzLL.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=S("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=S("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),X=()=>{const[m,x]=l.useState([]),[a,n]=l.useState({id:"",name:"",dosage:"",frequency:"daily",time:"08:00",notes:""}),[q,u]=l.useState(!1),[A,b]=l.useState(!0),{toast:c}=U(),y=L(w),v=V(w);l.useEffect(()=>{T()},[]);const T=async()=>{b(!0);try{const s=y.currentUser;if(!s){b(!1);return}const t=k(v,"users",s.uid),i=await z(t);i.exists()&&i.data().medications?x(i.data().medications):x([])}catch(s){console.error("Error loading medications:",s),c({title:"Error",description:"Failed to load your medications. Please try again.",variant:"destructive"})}finally{b(!1)}},N=async s=>{try{const t=y.currentUser;if(!t)return;const i=k(v,"users",t.uid);await K(i,{medications:s},{merge:!0}),c({title:"Success",description:"Your medications have been saved."})}catch(t){console.error("Error saving medications:",t),c({title:"Error",description:"Failed to save your medications. Please try again.",variant:"destructive"})}},E=()=>{if(!a.name||!a.dosage){c({title:"Error",description:"Please enter a medication name and dosage.",variant:"destructive"});return}const s={...a,id:Date.now().toString()},t=[...m,s];x(t),N(t),n({id:"",name:"",dosage:"",frequency:"daily",time:"08:00",notes:""}),u(!1)},F=s=>{const t=m.filter(i=>i.id!==s);x(t),N(t)},I=()=>{"Notification"in window&&Notification.requestPermission().then(s=>{c(s==="granted"?{title:"Notifications Enabled",description:"You will now receive medication reminders."}:{title:"Notifications Disabled",description:"Please enable notifications to receive medication reminders.",variant:"destructive"})})},P=s=>{const t=new Date,[i,R]=s.time.split(":").map(Number),r=new Date;r.setHours(i,R,0,0),r<t&&(s.frequency==="daily"?r.setDate(r.getDate()+1):s.frequency==="weekly"&&r.setDate(r.getDate()+7));const p=r.getTime()-t.getTime(),g=Math.floor(p/(1e3*60*60)),j=Math.floor(p%(1e3*60*60)/(1e3*60));return g===0&&j===0?"Now":g===0?`In ${j}m`:`In ${g}h ${j}m`};return A?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-safebite-teal"})}):e.jsxs("div",{className:"space-y-4",children:[q?e.jsx(C,{className:"bg-safebite-card-bg border-safebite-card-bg-alt",children:e.jsxs(M,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-safebite-text mb-4",children:"Add Medication"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"med-name",className:"text-safebite-text",children:"Medication Name"}),e.jsx(h,{id:"med-name",value:a.name,onChange:s=>n({...a,name:s.target.value}),placeholder:"e.g., Aspirin",className:"bg-safebite-card-bg-alt border-safebite-card-bg-alt"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"med-dosage",className:"text-safebite-text",children:"Dosage"}),e.jsx(h,{id:"med-dosage",value:a.dosage,onChange:s=>n({...a,dosage:s.target.value}),placeholder:"e.g., 81mg, 1 tablet",className:"bg-safebite-card-bg-alt border-safebite-card-bg-alt"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"med-frequency",className:"text-safebite-text",children:"Frequency"}),e.jsxs(H,{value:a.frequency,onValueChange:s=>n({...a,frequency:s}),children:[e.jsx(W,{className:"bg-safebite-card-bg-alt border-safebite-card-bg-alt",children:e.jsx(Z,{placeholder:"Select frequency"})}),e.jsxs(G,{children:[e.jsx(f,{value:"daily",children:"Daily"}),e.jsx(f,{value:"twice-daily",children:"Twice Daily"}),e.jsx(f,{value:"weekly",children:"Weekly"}),e.jsx(f,{value:"as-needed",children:"As Needed"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"med-time",className:"text-safebite-text",children:"Time"}),e.jsx(h,{id:"med-time",type:"time",value:a.time,onChange:s=>n({...a,time:s.target.value}),className:"bg-safebite-card-bg-alt border-safebite-card-bg-alt"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"med-notes",className:"text-safebite-text",children:"Notes (optional)"}),e.jsx(h,{id:"med-notes",value:a.notes,onChange:s=>n({...a,notes:s.target.value}),placeholder:"e.g., Take with food",className:"bg-safebite-card-bg-alt border-safebite-card-bg-alt"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(d,{variant:"outline",onClick:()=>u(!1),className:"border-safebite-card-bg-alt",children:"Cancel"}),e.jsxs(d,{onClick:E,className:"bg-safebite-teal text-safebite-dark-blue hover:bg-safebite-teal/80",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Save"]})]})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-safebite-text",children:"Your Medications"}),e.jsxs(d,{onClick:()=>u(!0),className:"bg-safebite-teal text-safebite-dark-blue hover:bg-safebite-teal/80",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Add"]})]}),m.length===0?e.jsxs("div",{className:"text-center py-8 text-safebite-text-secondary",children:[e.jsx(D,{className:"h-12 w-12 mx-auto mb-3 text-safebite-text-secondary opacity-50"}),e.jsx("p",{children:"No medications added yet."}),e.jsx("p",{className:"text-sm",children:"Add your medications to get reminders."})]}):e.jsxs("div",{className:"space-y-3",children:[m.map(s=>e.jsx(C,{className:"bg-safebite-card-bg-alt border-safebite-card-bg-alt",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-safebite-teal mr-2"}),e.jsx("h4",{className:"font-medium text-safebite-text",children:s.name})]}),e.jsx("p",{className:"text-sm text-safebite-text-secondary mt-1",children:s.dosage}),e.jsxs("div",{className:"flex items-center mt-2 text-xs text-safebite-text-secondary",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[s.time," â€¢ ",s.frequency.charAt(0).toUpperCase()+s.frequency.slice(1)]})]}),s.notes&&e.jsx("p",{className:"text-xs text-safebite-text-secondary mt-2",children:s.notes})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 hover:bg-red-500/10",onClick:()=>F(s.id),children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx("div",{className:"text-xs font-medium text-safebite-teal mt-2",children:P(s)})]})]})})},s.id)),e.jsxs(d,{variant:"outline",className:"w-full mt-4 border-dashed border-safebite-text-secondary text-safebite-text-secondary",onClick:I,children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Enable Reminders"]})]})]}),e.jsx("div",{className:"text-xs text-safebite-text-secondary mt-4",children:e.jsx("p",{children:"Note: This tool is for personal medication tracking only. Always follow your healthcare provider's instructions."})})]})};export{X as default};
